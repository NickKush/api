Общий API
==========
- [**Пользователь**](#Пользователь)
    - [`POST` `P` `/api/user` Данные пользователя](#Данные-пользователя)
    - [`POST` `P` `/api/user/list` Данные списка пользователей](#Данные-списка-пользователей)
    - [`POST` `P` `/api/user/current` Данные текущего пользователя](#Данные-текущего-пользователя)
    - [`POST` `RA` `/api/user/full` Полные данные пользователя](#Полные-данные-пользователя)
    - [`POST` `C` `/api/user/login` Логин](#Логин)
    - [`POST` `P` `/api/user/logout` Логаут](#Логаут)
    - [`POST` `A` `/api/user/settings` Получить или установить настройки текущего пользователя](#Получить-или-установить-настройки-текущего-пользователя)
    - [`POST` `P` `/api/user/forgot` Запрос на сброс пароля](#Запрос-на-сброс-пароля)
    - [`POST` `P` `/api/user/restore` Установка пароля](#Установка-пароля)
    - [`POST` `RA` `/api/user/roles/list` Список пользователей с ролью](#Список-пользователей-с-ролью)
    - [`POST` `RA` `/api/user/roles/set` Изменить роль пользователя](#Изменить-роль-пользователя)
- [**Категория**](#Категория)
    - [`POST` `P` `/api/category` Категория контента](#Категория-контента)
- [**Стрим**](#Стрим)
    - [`POST` `P` `/api/stream` Данные стрима](#Данные-стрима)
    - [`POST` `P` `/api/stream/preview` Ссылка на видео превью стрима](#Ссылка-на-видео-превью-стрима)
- [**Чат**](#Чат)
    - [`POST` `P` `/api/channel/data` Данные каналов](#Данные-каналов)
    - [`POST` `P` `/api/channel/private` Список приват каналов](#Список-приват-каналов)
- [**Фильтр**](#Фильтр)
    - [`POST` `A/P` `/api/content` Список элементов контента](#Список-элементов-контента)
    - [`POST` `P` `/api/content/top` Топ N элементов контента](#Топ-n-элементов-контента)
- [**Подписки**](#Подписки)
    - [`POST` `A` `/api/subscribe/add` Подписаться](#Подписаться)
    - [`POST` `A` `/api/subscribe/amount` Количество активных подписок](#Количество-активных-подписок)
    - [`POST` `A` `/api/subscribe/check` Проверить подписку](#Проверить-подписку)
    - [`POST` `A` `/api/subscribe/list` Список подписок](#Список-подписок)
    - [`POST` `A` `/api/subscribe/remove` Отписаться](#Отписаться)
    - [`POST` `A` `/api/subscribe/subscribers` Список подписчиков пользователя](#Список-подписчиков-пользователя)
- [**Игноры**](#Игноры)
    - [`POST` `A` `/api/ignore/add` Добавить в список игнорируемых](#Добавить-в-список-игнорируемых)
    - [`POST` `A` `/api/ignore/check` Проверить на игнор](#Проверить-на-игнор)
    - [`POST` `A` `/api/ignore/list` Список игнорируемого](#Список-игнорируемого)
    - [`POST` `A` `/api/ignore/remove` Удалить из списка игнорируемого](#Удалить-из-списка-игнорируемого)
- [**Мастерстримеры**](#Мастерстримеры)
    - [`POST` `P` `/api/masterstreamer/list` Список иконок и смайлов мастерстримеров](#Список-иконок-и-смайлов-мастерстримеров)
    - [`POST` `P` `/api/masterstreamer/icon/list` Список выбранных пользователями иконок](#Список-выбранных-пользователями-иконок)
- [**Расписание**](#Расписание)
    - [`POST` `P` `/api/schedule/get` Список расписания](#Список-расписания)
    - [`POST` `Sc` `/api/schedule/my` Расписание пользователя](#Расписание-пользователя)
    - [`POST` `Sc` `/api/schedule/set` Изменить расписание пользователя](#Изменить-расписание-пользователя)
- [**Майлстоуны**](#Майлстоуны)
    - [`POST` `P` `/api/milestone/get` Список майлстоунов](#Список-майлстоунов)
    - [`POST` `A` `/api/milestone/my` Майлстоуны пользователя](#Майлстоуны-пользователя)
    - [`POST` `A` `/api/milestone/set` Изменить майлстоуны пользователя](#Изменить-майлстоуны-пользователя)
- [**Сезоны соревнования**](#Сезоны-соревнования)
    - [`POST` `P` `/api/season/get` Данные текущего сезона](#Данные-текущего-сезона)
    - [`POST` `Se` `/api/season/start` Старт сезона](#Старт-сезона)
    - [`POST` `Se` `/api/season/stop` Завершение сезона](#Завершение-сезона)
    - [`POST` `P` `/api/season/top` Топ сезона](#Топ-сезона)
- [**Дополнительные вызовы**](#Дополнительные-вызовы)
    - [`POST` `P` `/api/bulk` Пакетный запрос](#Пакетный-запрос)


## Пользователь

#### Данные пользователя
##### [`POST` `P` `/api/user`](https://funstream.tv/api/user)
**запрос**
```js
{
    id: <int|null>, // Идентификатор пользователя
    name: <string|null> // Имя пользователя
}
```
**ответ**
```js
{
    id: <int>, // Идентификатор пользователя
    name: <string>, // Имя пользователя
    block: <bool> // Статус блокировки, false по умолчанию
}
```
*Может быть передан любой из параметров запроса.*  
*Вернёт ошибку если пользователь с таким идентификатором или именем не найден.*


#### Данные списка пользователей
##### [`POST` `P` `/api/user/list`](https://funstream.tv/api/user/list)
**запрос**
```js
{
    ids: <array> [ // Массив пользователей
        <int>, // Идентификатор пользователя
        ...
    ]
}
```
**ответ**
```js
[
    <obj>, // Объект из ответа /api/user
    ...
]
```
*[`/api/user`](#Данные-пользователя)*  
*Вернёт данные для всех существующих пользователей. Порядок в ответе может не совпадать с порядком идентификаторов в запросе.*


#### Данные текущего пользователя
##### [`POST` `P` `/api/user/current`](https://funstream.tv/api/user/current)
**запрос**
```js
{}
```
**ответ**, *если токена авторизации нет или он неверный*
```js
{
    guest: true,
    settings: <obj>, // Настройки пользователя по умолчанию, объект из ответа /api/user/settings
    roles: <obj> // Роли пользователя, значения по умолчанию, см. ниже
}
```
**ответ**, *если токен авторизации верен*
```js
{
    guest: false,
    id: <int>, // Идентификатор пользователя
    name: <string>, // Имя пользователя
    block: <bool>, // Статус блокировки, false по умолчанию
    settings: <obj>, // Настройки пользователя, объект из ответа /api/user/settings
    roles: <obj> { // Роли пользователя
        support: <bool>, // Сапорт, false по умолчанию
        canUseSupport: <bool>, // Возможность задавать вопрос саппортам и присоединяться к чат каналам вопросов, true по умолчанию
        moderator: <bool>, // Модератор, false по умолчанию
        citizen: <int>, // Сила голоса гражданской модерации, 2 по умолчанию
        twitch: <bool>, // Привязка твитч аккаунта, false по умолчанию
        blocker: <bool>, // Возможность блокировать аккаунт пользователя, false по умолчанию
        masterstreamer: <bool>, // Мастерстример, false по умолчанию
        smiler: <bool>, // Возможность редактировать смайлы, false по умолчанию
        roleAdmin: <bool>, // Возможность редактировать роли других пользователей, false по умолчанию
        schedule: <bool>, // Возможность изменять своё расписание, false по умолчанию
        seasoner: <bool> // Возможность управлять сезонами соревнования, false по умолчанию
    }
}
```


#### Полные данные пользователя
##### [`POST` `RA` `/api/user/full`](https://funstream.tv/api/user/full)
**запрос**
```js
{
    id: <int|null>, // Идентификатор пользователя
    name: <string|null> // Имя пользователя
}
```
**ответ**
```js
{
    id: <int>, // Идентификатор пользователя
    name: <string>, // Имя пользователя
    block: <bool>, // Статус блокировки, false по умолчанию
    roles: <string>, // Роли пользователя, объект из ответа /api/user/current
    settings: <string> // Настройки пользователя, объект из ответа /api/user/settings
}
```
*[`/api/user/current`](#Данные-текущего-пользователя), [`/api/user/settings`](#Получить-или-установить-настройки-текущего-пользователя)*  
*Может быть передан любой из параметров запроса.*  
*Вернёт ошибку если пользователь не имеет роли `roleAdmin`, запрашиваемый пользователь с таким идентификатором или именем не найден.*


#### Логин
##### [`POST` `C` `/api/user/login`](https://funstream.tv/api/user/login)
**запрос**
```js
{
    name: <string>, // Имя пользлователя
    password: <string>, // Пароль пользователя
    recaptchaResponse: <string> // Строка ответа Рекапчи
}
```
**ответ**
```js
{
    token: <string>, // Строка с токеном
    current: <obj> // Данные пользователя, объект из ответа /api/user/current
}
```
*Работает только на funstream.tv из-за использования Рекапчи.*  
*При успешном логине высталяется http-only кука, необходимая для прелоада funstream.tv.*  
*Вернёт ошибку если пользователь с таким именем и паролем не найден или капча не верна.*


#### Логаут
##### [`POST` `A` `/api/user/logout`](https://funstream.tv/api/user/logout)
**запрос**
```js
{}
```
**ответ**
```js
[]
```
*Уничтожает куку, установленную при логине.*  
*Вернёт ошибку если передан неверный токен.*


#### Получить или установить настройки текущего пользователя
##### [`POST` `A` `/api/user/settings`](https://funstream.tv/api/user/settings)
**запрос и ответ идентичны**
```js
{
    stream: <obj> {
        autostart: <bool>, // Автостарт плеера стрима, true по умолчанию,
        player: <string>, // Предпочитаемый плеер, по умолчанию пусто, приоретный плеер twitch.tv
        skipmain: <bool> // Пропускать главную страницу при прямом открытии ссылки funstream.tv, false по умолчанию
    },
    chat: <obj> {
        smiles: <bool>, // Показывать смайлы, true по умолчанию"
        images: <bool>, // Показывать миниатюру картинок в чате, false по умолчанию
        fontsize: <int>, // Размер шрифта чата, 12 по умолчанию
        namecolor: <int>, // Номер цвета ника, 0 по умолчанию
        mychannels: <array of strings>, // Список идентификаторов закрепленных каналов пользователя, пустой массив по умолчанию
        theme: <string>, // Тема формления чата, 'sc2tv' по умолчанию
        disablenamecolor: <bool>, // Отключить цветные ники, false по умолчанию
        thirdparty: <bool>, // Показывать сообщения Твича и Гудгейма, true по умолчанию
        favoritesmiles: <array of strings>, // Список кодов избранных смайлов, пустой массив по умолчанию
        thirdpartydontmask: <bool>, // Не затемнять сообщения с других сервисов, false по умолчанию
        imagesgif: <bool>, // Отображать анимированные картинки, true по умолчанию
        submode: <string>, // Сабмод режим чата своего стрима, [none | level], none по умолчанию
        totalignore: <bool>, // Режим полного игнора, false по умолчанию
        thirdpartysmiles: <bool> // Отображать смайлы Твитча, true по умолчанию
    }
}
```
*В параметрах запроса могут отсутствовать любые поля или все сразу.
Все переданные в параметрах запроса настройки будут сохранены для текущего пользователя.*  
*Вернёт ошибку если токена авторизации нет, он неверен, или указаны ошибочные настройки.*


#### Запрос на сброс пароля
##### [`POST` `P` `/api/user/forgot`](https://funstream.tv/api/user/forgot)
**запрос**
```js
{
    email: <string> // Почта аккаунта к которому необходимо сбросить пароль
}
```
**ответ**
```js
[]
```
*Если был указан верный почтовый адрес, то отправляет на него письмо с новым паролем и ссылкой по которой пароль будет установлен.*


#### Установка пароля
##### [`POST` `P` `/api/user/restore`](https://funstream.tv/api/user/restore)
**запрос**
```js
{
    code: <string> // Код по которому соответствующему аккаунту будет установлен новый пароль(присланный на почту)
}
```
**ответ**
```js
{
    // Данные логина, ответ /api/user/login
}
```
*[`/api/user/login`](#Логин)*  
*Вернёт ошибку если был передан неверный или использованный код, или не найден пользователь по коду.*


#### Список пользователей с ролью
##### [`POST` `RA` `/api/user/roles/list`](https://funstream.tv/api/user/roles/list)
**запрос**
```js
{
    role: <string> // Название роли
}
```
**ответ**
```js
[
    <obj> // Данные пользователя, объект из ответа /api/user
    ...
]
```
*[`/api/user`](#Данные-пользователя)*  
*Вернёт ошибку если пользователь не имеет роли `roleAdmin`.*


#### Изменить роль пользователя
##### [`POST` `RA` `/api/user/roles/set`](https://funstream.tv/api/user/roles/set)
**запрос**
```js
{
    userId: <int>, // Идентификатор пользователя
    role: <string>, // Название роли
    value: <bool|int> // Новое значение роли
}
```
**ответ**
```js
[]
```
*Вернёт ошибку если пользователь не имеет роли `roleAdmin`, передан неверный идентификатор пользователя или значение роли не bool|int.*


## Категория

#### Категория контента
##### [`POST` `P` `/api/category`](https://funstream.tv/api/category)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream, support]
    id: <int|null>, // Идентификатор категории
    slug: <string|null>, // Короткое имя категории
    options: <object|null> {
        subCategories: <bool|null>, // Включая 1 уровень подкатегорий, false, по умолчанию
        contentAmount: <bool|null> // Включая количество контента, false по умолчанию
    }
}
```
**ответ**
```js
{
    id: <int>, // Идентификатор категории
    slug: <string>, // Короткое имя категории
    name: <string>, // Полное имя категории
    subCategories: <array|null>, // Подкатегории, массив объектов с полями id, slug, name и contentAmount(если выставленна соответствующая опция)
    contentAmount: <int|null> // Количество контента
}
```
*Корневая категория для любого контента ищется по `slug: 'top'`.*  
*Вернёт ошибку если категория с таким id или slug не найдена.*


## Стрим

#### Данные стрима
##### [`POST` `P` `/api/stream`](https://funstream.tv/api/stream)
**запрос**
```js
{
    id: <int|null>, // Идентификатор стрима
    owner: <string|null>, // Имя стримера
    options: <obj|null> {
        players: <bool|null> // Вернуть плееры стрима, false по умолчанию
    }
}
```
**ответ**
```js
{
    id: <int>, // Идентификатор стрима
    owner: <obj>, // Данные стримера, объект из ответа /api/user
    name: <string>, // Заголовок стрима
    description: <string>, // Описание стрима
    category: <obj>, // Категория стрима, объект из ответа /api/category
    image: <string>, // Относительная ссылка на картинку заставки
    thumbnail: <string>, // Относительная ссылка на картинку превью
    adult: <bool>, // Флаг 18+
    start_at: <int>, // Время начала стрима, unixtime, 0 по умолчанию
    rating: <int>, // Текущий рейтинг стрима
    players: <array|null> [ // Активные(онлайн) плееры стрима
        {
            name: <string>, // Сервис плеера
            channel: <string>, // Имя канала плеера
            code: <string> // HTML код плеера с учётом настроек пользователя
        },
        ...
    ]
}
```
*Вернёт ошибку если стрима с данным id или именем стримера не существует.*


#### Ссылка на видео превью стрима
##### [`POST` `P` `/api/stream/preview`](https://funstream.tv/api/stream/preview)
**запрос**
```js
{
    id: <int> // Идентификатор стрима
}
```
**ответ**
```js
{
    url: <string> // Ссылка на видео превью
}
```
*Вернёт ссылку на видео превью если у стрима есть Twitch или GoodGame плеер.*


## Чат

#### Данные каналов
##### [`POST` `P` `/api/channel/data`](https://funstream.tv/api/channel/data)
**запрос**
```js
{
    channels: <array> [ // Список каналов
        <string>, // Идентификатор канала
        ...
    ]
}
```
**ответ**
```js
[
    {
        id: <string>, // Идентификатор канала
        name: <string>, // Имя канала
        user: <obj|null> // Владелец канала, объект из ответа /api/user
    },
    ...
]
```
*Вернёт ошибку если хотя бы один из переданных идентификаторов неверен или список каналов пуст.*


#### Список приват каналов
##### [`POST` `A` `/api/channel/private`](https://funstream.tv/api/channel/private)
**запрос**
```js
{}
```
**ответ**
```js
[
    <string>, // Идентификатор канала
    ...
]
```
*Возвращает последние 30 приват каналов пользователя. Сортировка по последнему сообщению. На данный момент не фильтрует приваты с заигноренными пользователями, необходимо делать это вручную.*  
*Вернёт ошибку если пользователь не залогинен или передан неверный токен.*



## Фильтр

#### Список элементов контента
##### [`POST` `A/P` `/api/content`](https://funstream.tv/api/content)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream]
    type: <string>, // Тип фильтра, [all, my]
    category: <obj> { // Категория, любой из параметров
        id: <int|null>, // Идентификатор категории
        slug: <string|null> // Короткое имя категории, top для верхней
    }
}
```
**ответ**
```js
{
    category: <obj> {
        parent: <obj|null>, // Родительская категория относительно переданной, объект из ответа /api/category
        current: <obj>, // Данные переданной категории, объект из ответа /api/category с contentAmount=true, subCategories=true с добавленным полем 'weight' для каждой категории
    },
    content: <array> [
        <obj>, // Данные соотвествующего элемента контента, см ниже
        ...
    ]
}
```
*Вернёт список стримов, отсортированных по текущему рейтингу. Поле `weight <int>` у категорий(текущей и дочерних) это суммарный теукщий рейтинг стримов в этой категории. Сортировка дочерних категорий по этому параметру.*  
*Если тип `my` то вернёт список онлайн стримов из избранного пользрвателя*  
*Вернёт ошибку если переданы неверные данные каегории, контент или тип.*  
*Вернёт ошибку если передан тип `my` и пользователь не залогинен или передан неверный токен.*  


#### Топ N элементов контента
##### [`POST` `P` `/api/content/top`](https://funstream.tv/api/content/top)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream]
    category: <obj> { // Категория, любой из параметров
        id: <int|null>, // Идентификатор категории
        slug: <string|null> // Короткое имя категории, top для верхней
    },
    amount: <int> // Количество элементов в ответе
}
```
**ответ**
```js
{
    content: <array> [
        <obj> // Данные соотвествующего элемента контента, см ниже
        ...,
    ]
}
```
*Вернёт top-{amount} стримов, отсортированных по рейтингу.*  
*Вернёт ошибку если переданы неверные данные категории или контент.*

#### Поля элемента контента

В ответе запросов фильтра у элемента контента есть обязательные поля(присутствуют всегда)
```js
{
    id: <int>, // Идентификатор элемента контента
    owner: <obj>, // Владелец, объект из ответа /api/user
    name: <string>, // Название
    adult: <bool>, // Флаг 18+
    rating: <int> // Рейтинг
}
```
*[`/api/user`](#Данные-пользователя)*

И необязательные, зависят от типа контента
```js
{
    // stream
    description: <string>, // Описание
    image: <string>, // Ссылка на картинку стрима
    thumbnail: <string>, // Ссылка на превью стрима
    start_at: <int>, // Время начала стрима, unixtime


    // room
}
```


## Подписки

#### Подписаться
##### [`POST` `A` `/api/subscribe/add`](https://funstream.tv/api/subscribe/add)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream]
    id: <int> // Идентификатор элемента контента
}
```
**ответ**
```js
[]
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Количество активных подписок
##### [`POST` `A` `/api/subscribe/amount`](https://funstream.tv/api/subscribe/amount)
**запрос**
```js
{
    content: <string> // Тип контента, [stream]
}
```
**ответ**
```js
{
    amount: <int> // Количество активных подписок
}
```
*Вернёт количество активных(онлайн) элементов в подписках у пользователя.*  
*Вернёт ошибку если передан наверный тип контента, пользователь не залогинен или передан неверный токен.*


#### Проверить подписку
##### [`POST` `A` `/api/subscribe/check`](https://funstream.tv/api/subscribe/check)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream]
    id: <int> // Идентификатор элемента контента
}
```
**ответ**
```js
{
    result: <bool> // true в случае наличия подписки
}
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Список подписок
##### [`POST` `A` `/api/subscribe/list`](https://funstream.tv/api/subscribe/list)
**запрос**
```js
{
    content: <string> // Тип контента, [stream]
}
```
**ответ**
```js
[
    <obj>, // Данные элемента контента, объект из ответа /api/stream
    ...
]
```
*В данный момент работает неверно.*  
*Вернёт ошибку если передан наверный тип контента, пользователь не залогинен или передан неверный токен.*


#### Отписаться
##### [`POST` `A` `/api/subscribe/remove`](https://funstream.tv/api/subscribe/remove)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream]
    id: <int> // Идентификатор элемента контента
}
```
**ответ**
```js
[]
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Список подписчиков пользователя
##### [`POST` `A` `/api/subscribe/subscribers`](https://funstream.tv/api/subscribe/subscribers)
**запрос**
```js
{
    content: <string> // Тип контента, [stream]
}
```
**ответ**
```js
[
    <obj>, // Данные юзера, объект из ответа /api/user
    ...
]
```
*Вернёт список подписчиков на текущего юзера, если он является стримером(имеет запись о стриме в бд).*  
*Вернёт ошибку если передан наверный тип контента, пользователь не залогинен или передан неверный токен.*


## Игноры

#### Добавить в список игнорируемых
##### [`POST` `A` `/api/ignore/add`](https://funstream.tv/api/ignore/add)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream, chat]
    item: <int> // Идентификатор элемента контента
}
```
**ответ**
```js
[]
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Проверить на игнор
##### [`POST` `A` `/api/ignore/check`](https://funstream.tv/api/ignore/check)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream, chat]
    item: <int> // Идентификатор элемента контента
}
```
**ответ**
```js
{
    ignored: <bool> // true если в игноре
}
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Список игнорируемого
##### [`POST` `A` `/api/ignore/list`](https://funstream.tv/api/ignore/list)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream, chat]
}
```
**ответ**
```js
[
    {
        content: <string>, // Тип контента, [stream, chat]
        item: <int> // Идентификатор элемента контента
    },
    ...
]
```
*Вернёт ошибку если передан наверный тип контента, пользователь не залогинен или передан неверный токен.*


#### Удалить из списка игнорируемого
##### [`POST` `A` `/api/ignore/remove`](https://funstream.tv/api/ignore/remove)
**запрос**
```js
{
    content: <string>, // Тип контента, [stream, chat]
    item: <int> // Идентификатор элемента контента
}
```
**ответ**
```js
[]
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


## Мастерстримеры

#### Список иконок и смайлов мастерстримеров
##### [`POST` `P` `/api/masterstreamer/list`](https://funstream.tv/api/masterstreamer/list)
**запрос**
```js
{}
```
**ответ**
```js
[
    <obj> { // Данные мастерстримера
        userId: <int>, // Идентификатор пользователя
        icon: <string|null>, // Полная ссылка на иконку, если она есть
        smiles: <array> [ // Список смайлов
            <obj>, // Данные смайла, объект из ответа /api/smile
            ...,
        ]
    ],
    ...
]
```
*[`/api/smile`](smile.md#Доступные-смайлы)*  
*Список мастерстримеров, у которых одобрен хотя бы один смайл.*


#### Список выбранных пользователями иконок
##### [`POST` `P` `/api/masterstreamer/icon/list`](https://funstream.tv/api/masterstreamer/icon/list)
**запрос**
```js
{}
```
**ответ**
```js
[
    <obj> { // Данные выбранной пользователем иконки
        userId: <int>, // Идентификатор пользователя
        streamerId: <int>, // Идентификатор стримера, если это иконка мастерстримера, иначе 0
        icon: <string>, // Полная ссылка на выбранную иконку
    ],
    ...
]
```
*Список пользователей, выбравших конкретную иконку, с данными этой иконки. Если `streamerId` 0, то у пользователя выбрана кастомная иконка не связанная с мастерстримерами. Если пользователь не выбирал конкретную иконку, то независимо от наличия доступных ему иконок, его нет в этом списке.*


## Расписание

#### Список расписания
##### [`POST` `P` `/api/schedule/get`](https://funstream.tv/api/schedule/get)
**запрос**
```js
{}
```
**ответ**
```js
[
    <obj> { // Данные записи в расписании
        description: <string>, // Описание
        time: <int>, // Время начала, unixtime
        online: <bool>, // Онлайн статус стрима
        nodeId: <int>, // nodeId sc2tv для ссылки на стрим /node/<nodeId>
        user: <int> // Данные стримера, объект из ответа /api/user
    ],
    ...
]
```
*[`/api/user`](#Данные-пользователя)*


#### Расписание пользователя
##### [`POST` `Sc` `/api/schedule/my`](https://funstream.tv/api/schedule/my)
**запрос**
```js
{}
```
**ответ**
```js
[
    <obj> { // Данные записи в расписании
        description: <string>, // Описание
        time: <int>, // Время начала, unixtime
        user: <int> // Данные стримера, объект из ответа /api/user
    ],
    ...
]
```
*Вернёт ошибку если текущий пользователь не имеет роли `schedule`.*


#### Изменить расписание пользователя
##### [`POST` `Sc` `/api/schedule/set`](https://funstream.tv/api/schedule/set)
**запрос**
```js
{
    schedule: [ // Новое расписание
        <obj> { // Данные записи в расписании
            description: <string>, // Описание
            time: <int> // Время начала, unixtime
        },
        ...
    ]
}
```
**ответ**
```js
{}
```
*Вернёт ошибку если текущий пользователь не имеет роли `schedule`.*


## Майлстоуны

#### Список майлстоунов
##### [`POST` `P` `/api/milestone/get`](https://funstream.tv/api/milestone/get)
**запрос**
```js
{
    streamerId: <int> // Идентификатор стримера
}
```
**ответ**
```js
{
    startPoint: <int>, // Время отсчёта собираемого доната, unixtime
    donatedAmount: <float>, // Собранный донат с указанного времени
    milestones: [ // Список майлстоунов
        <obj> { // Данные майлстоуна
            active: <bool>, // Флаг активного майлстоуна, false если собрано/выполнено
            amount: <float>, // Необходимая сумма с времени отсчёта
            description: <string>, // Описание майлстоуна
            url: <string> // Ссылка на запись выполненнного майлстоуна
        },
        ...
    ]
}
```
*Вернёт ошибку если стример не выставил время отсчёта.*


#### Майлстоуны пользователя
##### [`POST` `A` `/api/milestone/my`](https://funstream.tv/api/milestone/my)
**запрос**
```js
{}
```
**ответ**
```js
{
    startPoint: <int>, // Время отсчёта собираемого доната, unixtime
    milestones: [ // Список майлстоунов
        // Массив milestones из ответа /api/milestone/get
    ]
}
```
*[`/api/milestone/get`](#Список-майлстоунов)*  
*Майлстоуны текущего пользователя.*


#### Изменить майлстоуны пользователя
##### [`POST` `A` `/api/milestone/set`](https://funstream.tv/api/milestone/set)
**запрос**
```js
{
    startPoint: <int>, // Время отсчёта собираемого доната, unixtime
    milestones: [ // Список майлстоунов
        // Массив milestones из ответа /api/milestone/get
    ]
}
```
**ответ**
```js
[]
```
*[`/api/milestone/get`](#Список-майлстоунов)*  
*Вернёт ошибку если не указано любое из полей майлстоунов.*


## Сезоны соревнования

#### Данные текущего сезона
##### [`POST` `P` `/api/season/get`](https://funstream.tv/api/season/get)
**запрос**
```js
{}
```
**ответ**
```js
{
    start: <int>, // Время начала сезона, unixtime
    end: <int>, // Время завершения сезона, для активного 0, unixtime
    active: <bool> // Статус сезона
}
```
*Вернёт ошибку если сейчас нет активного сезона(:wtf:)*


#### Старт сезона
##### [`POST` `Se` `/api/season/start`](https://funstream.tv/api/season/start)
**запрос**
```js
{}
```
**ответ**
```js
[]
```
*Вернёт ошибку если есть активный сезон.*


#### Завершение сезона
##### [`POST` `Se` `/api/season/stop`](https://funstream.tv/api/season/stop)
**запрос**
```js
{}
```
**ответ**
```js
[]
```
*Вернёт ошибку если нет активного сезона.*


#### Топ сезона
##### [`POST` `P` `/api/season/top`](https://funstream.tv/api/season/top)
**запрос**
```js
{}
```
**ответ**
```js
[
    <obj> { // Участник соревнования
        user: <obj>, // Данные стримера, объект из ответа /api/user
        amount: <float>, // Собранная за сезон сумма
        online: <bool>, // Онлайн статус стрима
        nodeId: <int> // nodeId sc2tv для ссылки на стрим /node/<nodeId>
    },
    ...
]
```
*[`/api/user`](#Данные-пользователя)*  
*Список участников отсортирован по собранной сумме по уменьшению.*  
*Вернёт ошибку если нет активного сезона.*


## Дополнительные вызовы

#### Пакетный запрос
##### [`POST` `P` `/api/bulk`](https://funstream.tv/api/bulk)
**запрос**
```js
{
    command: <array> [ // Массив запросов
        <array> [ // Запрос
            <string>, // Урл запроса, например /api/user
            <obj> // Параметры запроса
        ],
        ...
    ]
}
```
**ответ**
```js
[
    <array> [ // Результат соответствующего запроса
        <string>, // Урл запроса, например /api/user
        <obj>, // Параметры запроса
        <obj|array>, // Ответ на запрос
        <bool> // Статус запроса, true на успешное выполнение
    ],
    ...
]
```
*Позволяет получить результаты нескольких запросов за один.*  
*Для каждого запроса возвращает массив с его данными, статусом выполнения и результатом. Индекс ответа соответствует индексу в массиве запросов.*  
*Если запрос дал ошибку, то в ответе на этот запрос будет объект ошибки и статус false.*
