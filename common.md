Общий API
==========
- [**Пользователь**](#Пользователь)
    - [`POST` `P` `/api/user` Данные пользователя](#Данные-пользователя)
    - [`POST` `P` `/api/user/list` Данные списка пользователей](#Данные-списка-пользователей)
    - [`POST` `P` `/api/user/current` Данные текущего пользователя](#Данные-текущего-пользователя)
    - [`POST` `RA` `/api/user/full` Полные данные пользователя](#Полные-данные-пользователя)
    - [`POST` `C` `/api/user/login` Логин](#Логин)
    - [`POST` `P` `/api/user/login/bytoken` Логин по токену](#Логин-по-токену)
    - [`POST` `P` `/api/user/logout` Логаут](#Логаут)
    - [`POST` `A` `/api/user/settings` Получить или установить настройки текущего пользователя](#Получить-или-установить-настройки-текущего-пользователя)
    - [`POST` `P` `/api/user/forgot` Запрос на сброс пароля](#Запрос-на-сброс-пароля)
    - [`POST` `P` `/api/user/restore` Установка пароля](#Установка-пароля)
    - [`POST` `RA` `/api/user/roles/list` Список пользователей с ролью](#Список-пользователей-с-ролью)
    - [`POST` `RA` `/api/user/roles/set` Изменить роль пользователя](#Изменить-роль-пользователя)
- [**Категория**](#Категория)
    - [`POST` `P` `/api/category` Категория контента](#Категория-контента)
- [**Стрим**](#Стрим)
    - [`POST` `P` `/api/stream` Данные стрима](#Данные-стрима)
    - [`POST` `P` `/api/stream/preview` Ссылка на видео превью стрима](#Ссылка-на-видео-превью-стрима)
- [**Чат**](#Чат)
    - [`POST` `P` `/api/channel/data` Данные каналов](#Данные-каналов)
    - [`POST` `P` `/api/channel/private` Список приват каналов](#Список-приват-каналов)
- [**Фильтр**](#Фильтр)
    - [`POST` `A/P` `/api/content` Список элементов контента](#Список-элементов-контента)
    - [`POST` `P` `/api/content/top` Топ N элементов контента](#Топ-n-элементов-контента)
- [**Подписки**](#Подписки)
    - [`POST` `A` `/api/subscribe/add` Подписаться](#Подписаться)
    - [`POST` `A` `/api/subscribe/amount` Количество активных подписок](#Количество-активных-подписок)
    - [`POST` `A` `/api/subscribe/check` Проверить подписку](#Проверить-подписку)
    - [`POST` `A` `/api/subscribe/list` Список подписок](#Список-подписок)
    - [`POST` `A` `/api/subscribe/remove` Отписаться](#Отписаться)
    - [`POST` `A` `/api/subscribe/subscribers` Список подписчиков пользователя](#Список-подписчиков-пользователя)
- [**Игноры**](#Игноры)
    - [`POST` `A` `/api/ignore/add` Добавить в список игнорируемых](#Добавить-в-список-игнорируемых)
    - [`POST` `A` `/api/ignore/check` Проверить на игнор](#Проверить-на-игнор)
    - [`POST` `A` `/api/ignore/list` Список игнорируемого](#Список-игнорируемого)
    - [`POST` `A` `/api/ignore/remove` Удалить из списка игнорируемого](#Удалить-из-списка-игнорируемого)
- [**Мастерстримеры**](#Мастерстримеры)
    - [`POST` `P` `/api/masterstreamer/list` Список иконок и смайлов мастерстримеров](#Список-иконок-и-смайлов-мастерстримеров)
    - [`POST` `P` `/api/masterstreamer/icon/list` Список выбранных пользователями иконок](#Список-выбранных-пользователями-иконок)
- [**Расписание**](#Расписание)
    - [`POST` `P` `/api/schedule/get` Список расписания](#Список-расписания)
    - [`POST` `Sc` `/api/schedule/my` Расписание пользователя](#Расписание-пользователя)
    - [`POST` `Sc` `/api/schedule/set` Изменить расписание пользователя](#Изменить-расписание-пользователя)
- [**Майлстоуны**](#Майлстоуны)
    - [`POST` `P` `/api/milestone/get` Список майлстоунов](#Список-майлстоунов)
    - [`POST` `A` `/api/milestone/my` Майлстоуны пользователя](#Майлстоуны-пользователя)
    - [`POST` `A` `/api/milestone/set` Изменить майлстоуны пользователя](#Изменить-майлстоуны-пользователя)
- [**Сезоны соревнования**](#Сезоны-соревнования)
    - [`POST` `P` `/api/season/get` Данные текущего сезона](#Данные-текущего-сезона)
    - [`POST` `Se` `/api/season/start` Старт сезона](#Старт-сезона)
    - [`POST` `Se` `/api/season/stop` Завершение сезона](#Завершение-сезона)
    - [`POST` `P` `/api/season/top` Топ сезона](#Топ-сезона)
- [**Уровни**](#Уровни)
    - [`POST` `A` `/api/level/my` Мои уровни](#Мои-уровни)
    - [`POST` `A` `/api/level/premiumUsers` Уровни моих премиум юзеров](#Уровни-моих-премиум-юзеров)
- [**Аукцион окончания стрима**](#Аукцион-окончания-стрима)
    - [`POST` `P` `/api/prolonger/active` Активные аукционы окончания стрима](#Активные-аукционы-окончания-стрима)
    - [`POST` `P` `/api/prolonger/get` Данные аукциона окончания стрима](#Данные-аукциона-окончания-стрима)
    - [`POST` `A` `/api/prolonger/start` Запустить аукцион окончания стрима](#Запустить-аукцион-окончания-стрима)
- [**Дополнительные вызовы**](#Дополнительные-вызовы)
    - [`POST` `P` `/api/bulk` Пакетный запрос](#Пакетный-запрос)


## Пользователь

#### Данные пользователя
##### [`POST` `P` `/api/user`](http://funstream.tv/api/user)
**запрос**
```ts
{
    id: number | null; // Идентификатор пользователя
    name: string | null; // Имя пользователя
}
```
**ответ**
```ts
{
    id: number; // Идентификатор пользователя
    name: string; // Имя пользователя
}
```
*Может быть передан любой из параметров запроса.*  
*Вернёт ошибку если пользователь с таким идентификатором или именем не найден.*


#### Данные списка пользователей
##### [`POST` `P` `/api/user/list`](http://funstream.tv/api/user/list)
**запрос**
```ts
{
    ids: [ // Список пользователей
        number, // Идентификатор пользователя
        ...
    ]
}
```
**ответ**
```ts
[
    Object, // Данные пользователя, объект из ответа /api/user
    ...
]
```
*[`/api/user`](#Данные-пользователя)*  
*Вернёт данные для всех существующих пользователей. Порядок в ответе может не совпадать с порядком идентификаторов в запросе.*


#### Данные текущего пользователя
##### [`POST` `P` `/api/user/current`](http://funstream.tv/api/user/current)
**запрос**
```ts
{}
```
**ответ**, *если токена авторизации нет или он неверный*
```ts
{
    guest: true;
    settings: Object; // Настройки пользователя по умолчанию, объект из ответа /api/user/settings
    roles: Object; // Роли пользователя, значения по умолчанию, см. ниже
}
```
**ответ**, *если токен авторизации верен*
```ts
{
    guest: false;
    id: number; // Идентификатор пользователя
    name: string; // Имя пользователя
    block: boolean; // Статус блокировки, false по умолчанию
    settings: Object; // Настройки пользователя, объект из ответа /api/user/settings
    roles: { // Роли пользователя
        support: boolean; // Сапорт, false по умолчанию
        canUseSupport: boolean; // Возможность задавать вопрос саппортам и присоединяться к чат каналам вопросов, true по умолчанию
        moderator: boolean; // Модератор, false по умолчанию
        citizen: number; // Сила голоса гражданской модерации, 2 по умолчанию
        twitch: boolean; // Привязка твитч аккаунта, false по умолчанию
        blocker: boolean; // Возможность блокировать аккаунт пользователя, false по умолчанию
        masterstreamer: boolean; // Мастерстример, false по умолчанию
        smiler: boolean; // Возможность редактировать смайлы, false по умолчанию
        roleAdmin: boolean; // Возможность редактировать роли других пользователей, false по умолчанию
        schedule: boolean; // Возможность изменять своё расписание, false по умолчанию
        seasoner: boolean; // Возможность управлять сезонами соревнования, false по умолчанию
    }
}
```


#### Полные данные пользователя
##### [`POST` `RA` `/api/user/full`](http://funstream.tv/api/user/full)
**запрос**
```ts
{
    id: number | null; // Идентификатор пользователя
    name: string | null; // Имя пользователя
}
```
**ответ**
```ts
{
    id: number; // Идентификатор пользователя
    name: string; // Имя пользователя
    block: boolean; // Статус блокировки, false по умолчанию
    roles: string; // Роли пользователя, объект из ответа /api/user/current
    settings: string; // Настройки пользователя, объект из ответа /api/user/settings
}
```
*[`/api/user/current`](#Данные-текущего-пользователя), [`/api/user/settings`](#Получить-или-установить-настройки-текущего-пользователя)*  
*Может быть передан любой из параметров запроса.*  
*Вернёт ошибку если пользователь не имеет роли `roleAdmin`, запрашиваемый пользователь с таким идентификатором или именем не найден.*


#### Логин
##### [`POST` `C` `/api/user/login`](https://funstream.tv/api/user/login)
**запрос**
```ts
{
    name: string; // Имя пользлователя
    password: string; // Пароль пользователя
    recaptchaResponse: string; // Строка ответа Рекапчи
}
```
**ответ**
```ts
{
    token: string; // Строка с токеном
    current: Object; // Данные текущего пользователя, объект из ответа /api/user/current
}
```
*[`/api/user/current`](#Данные-текущего-пользователя)*  
*Работает только на funstream.tv из-за использования Рекапчи, использует HTTPS протокол.*  
*При успешном логине высталяется http-only кука, необходимая для прелоада funstream.tv.*  
*Вернёт ошибку если пользователь с таким именем и паролем не найден или капча не верна.*


#### Логин по токену
##### [`POST` `P` `/api/user/login/bytoken`](https://funstream.tv/api/user/login/bytoken)
**запрос**
```ts
{
    token: string; // Токен пользователя
}
```
**ответ**
```ts
{
    ... // Данные текущего пользователя, объект из ответа /api/user/current
}
```
*[`/api/user/current`](#Данные-текущего-пользователя)*  
*Работает только с токеном, полученным при логине через сайт. OAuth токен даст ошибку.*  
*При успешном логине высталяется http-only кука, необходимая для прелоада funstream.tv.*  
*Вернёт ошибку если токен неверен.*


#### Логаут
##### [`POST` `A` `/api/user/logout`](http://funstream.tv/api/user/logout)
**запрос**
```ts
{}
```
**ответ**
```ts
[]
```
*Уничтожает куку, установленную при логине.*  
*Вернёт ошибку если передан неверный токен.*


#### Получить или установить настройки текущего пользователя
##### [`POST` `A` `/api/user/settings`](http://funstream.tv/api/user/settings)
**запрос и ответ идентичны**
```ts
{
    stream: {
        autostart: boolean; // Автостарт плеера стрима, true по умолчанию,
        player: string; // Предпочитаемый плеер, по умолчанию пусто, приоретный плеер twitch.tv
        skipmain: boolean; // Пропускать главную страницу при прямом открытии ссылки funstream.tv, false по умолчанию
        videopreview: boolean; // Показываеть видео превью стрима при наведении в списке, true по умолчанию
    },
    chat: {
        smiles: boolean; // Показывать смайлы, true по умолчанию"
        images: boolean; // Показывать миниатюру картинок в чате, false по умолчанию
        fontsize: number; // Размер шрифта чата, 12 по умолчанию
        namecolor: number; // Номер цвета ника, 0 по умолчанию
        mychannels: string[], // Список идентификаторов закрепленных каналов пользователя, пустой массив по умолчанию
        theme: string; // Тема формления чата, 'sc2tv' по умолчанию
        disablenamecolor: boolean; // Отключить цветные ники, false по умолчанию
        thirdparty: boolean; // Показывать сообщения Твича и Гудгейма, true по умолчанию
        favoritesmiles: string[], // Список кодов избранных смайлов, пустой массив по умолчанию
        thirdpartydontmask: boolean; // Не затемнять сообщения с других сервисов, false по умолчанию
        imagesgif: boolean; // Отображать анимированные картинки, true по умолчанию
        submode: string; // Сабмод режим чата своего стрима, [none | level], none по умолчанию
        totalignore: boolean; // Режим полного игнора, false по умолчанию
        thirdpartysmiles: boolean; // Отображать смайлы Твитча, true по умолчанию
        displayannounce: boolean; // Отображать анонсы стримов, true по умолчанию
        forcewss: boolean; // Использовать WSS соединение в чате, false по умолчанию
        smilesgif: boolean; // Отображать анимированные смайлы, true по умолчанию
    }
}
```
*В параметрах запроса могут отсутствовать любые поля или все сразу.  
Все переданные в параметрах запроса настройки будут сохранены для текущего пользователя.*  
*Вернёт ошибку если токена авторизации нет, он неверен, или указаны ошибочные настройки.*


#### Запрос на сброс пароля
##### [`POST` `P` `/api/user/forgot`](http://funstream.tv/api/user/forgot)
**запрос**
```ts
{
    email: string; // Почта аккаунта к которому необходимо сбросить пароль
}
```
**ответ**
```ts
[]
```
*Если был указан верный почтовый адрес, то отправляет на него письмо с новым паролем и ссылкой по которой пароль будет установлен.*


#### Установка пароля
##### [`POST` `P` `/api/user/restore`](http://funstream.tv/api/user/restore)
**запрос**
```ts
{
    code: string; // Код по которому соответствующему аккаунту будет установлен новый пароль(присланный на почту)
}
```
**ответ**
```ts
{
    // Данные логина, ответ /api/user/login
}
```
*[`/api/user/login`](#Логин)*  
*Вернёт ошибку если был передан неверный или использованный код, или не найден пользователь по коду.*


#### Список пользователей с ролью
##### [`POST` `RA` `/api/user/roles/list`](http://funstream.tv/api/user/roles/list)
**запрос**
```ts
{
    role: string; // Название роли
}
```
**ответ**
```ts
[
    Object, // Данные пользователя, объект из ответа /api/user
    ...
]
```
*[`/api/user`](#Данные-пользователя)*  
*Вернёт ошибку если пользователь не имеет роли `roleAdmin`.*


#### Изменить роль пользователя
##### [`POST` `RA` `/api/user/roles/set`](http://funstream.tv/api/user/roles/set)
**запрос**
```ts
{
    userId: number; // Идентификатор пользователя
    role: string; // Название роли
    value: any; // Новое значение роли
}
```
**ответ**
```ts
[]
```
*Вернёт ошибку если пользователь не имеет роли `roleAdmin`, передан неверный идентификатор пользователя или неверный тип данных для этой роли.*


## Категория

#### Категория контента
##### [`POST` `P` `/api/category`](http://funstream.tv/api/category)
**запрос**
```ts
{
    content: string; // Тип контента, [stream, support]
    id: number | null; // Идентификатор категории
    slug: string | null; // Короткое имя категории
    options: Object | null {
        subCategories: bool | null; // Включая 1 уровень подкатегорий, false, по умолчанию
        contentAmount: bool | null; // Включая количество контента, false по умолчанию
    }
}
```
**ответ**
```ts
{
    id: number; // Идентификатор категории
    slug: string; // Короткое имя категории
    name: string; // Полное имя категории
    subCategories: Array | null; // Подкатегории, массив объектов с полями id, slug, name и contentAmount(если выставленна соответствующая опция)
    contentAmount: number | null; // Количество контента
}
```
*Корневая категория для любого контента ищется по `slug: 'top'`.*  
*Вернёт ошибку если категория с таким id или slug не найдена.*


## Стрим

#### Данные стрима
##### [`POST` `P` `/api/stream`](http://funstream.tv/api/stream)
**запрос**
```ts
{
    id: number | null; // Идентификатор стрима
    owner: string | null; // Имя стримера
    options: Object | null {
        players: bool | null; // Вернуть плееры стрима, false по умолчанию
    }
}
```
**ответ**
```ts
{
    id: number; // Идентификатор стрима
    owner: Object; // Данные стримера, объект из ответа /api/user
    name: string; // Заголовок стрима
    description: string; // Описание стрима
    category: Object; // Категория стрима, объект из ответа /api/category
    image: string; // Относительная ссылка на картинку заставки
    thumbnail: string; // Относительная ссылка на картинку превью
    adult: boolean; // Флаг 18+
    start_at: unixtime; // Время начала стрима, 0 по умолчанию
    rating: number; // Текущий рейтинг стрима
    slug: string; // Имя стрима в ссылке, /stream/<slug>
    hidden: boolean; // Флаг скрытия стрима в списке
    players: Array | null [ // Активные(онлайн) плееры стрима
        {
            name: string; // Сервис плеера
            channel: string; // Имя канала плеера
            code: string; // HTML код плеера с учётом настроек пользователя
        },
        ...
    ]
}
```
*Вернёт ошибку если стрима с данным id или именем стримера не существует.*


#### Ссылка на видео превью стрима
##### [`POST` `P` `/api/stream/preview`](http://funstream.tv/api/stream/preview)
**запрос**
```ts
{
    id: number; // Идентификатор стрима
}
```
**ответ**
```ts
{
    url: string; // Ссылка на видео превью
}
```
*Вернёт ссылку на видео превью если у стрима есть Twitch или GoodGame плеер.*


## Чат

#### Данные каналов
##### [`POST` `P` `/api/channel/data`](http://funstream.tv/api/channel/data)
**запрос**
```ts
{
    channels: [ // Список каналов
        string, // Идентификатор канала
        ...
    ]
}
```
**ответ**
```ts
[
    {
        id: string; // Идентификатор канала
        name: string; // Имя канала
        user: Object | null; // Владелец канала, объект из ответа /api/user
    },
    ...
]
```
*Вернёт ошибку если хотя бы один из переданных идентификаторов неверен или список каналов пуст.*


#### Список приват каналов
##### [`POST` `A` `/api/channel/private`](http://funstream.tv/api/channel/private)
**запрос**
```ts
{}
```
**ответ**
```ts
[
    string, // Идентификатор канала
    ...
]
```
*Возвращает последние 30 приват каналов пользователя. Сортировка по последнему сообщению.
На данный момент не фильтрует приваты с заигноренными пользователями, необходимо делать это вручную.*  
*Вернёт ошибку если пользователь не залогинен или передан неверный токен.*



## Фильтр

#### Список элементов контента
##### [`POST` `A/P` `/api/content`](http://funstream.tv/api/content)
**запрос**
```ts
{
    content: string; // Тип контента, [stream]
    type: string; // Тип фильтра, [all, my]
    category: { // Категория, любой из параметров
        id: number | null; // Идентификатор категории
        slug: string | null; // Короткое имя категории, top для верхней
    }
}
```
**ответ**
```ts
{
    category: {
        parent: Object | null; // Родительская категория относительно переданной, объект из ответа /api/category
        current: Object; // Данные переданной категории, объект из ответа /api/category с contentAmount=true, subCategories=true с добавленным полем 'weight' для каждой категории
    },
    content: [
        Object, // Данные соотвествующего элемента контента, см ниже
        ...
    ]
}
```
*Вернёт список стримов, отсортированных по текущему рейтингу.
Поле `weight number` у категорий(текущей и дочерних) это суммарный теукщий рейтинг стримов в этой категории.
Сортировка дочерних категорий по этому параметру.*  
*Если тип `my` то вернёт список онлайн стримов из избранного пользрвателя*  
*Вернёт ошибку если переданы неверные данные каегории, контент или тип.*  
*Вернёт ошибку если передан тип `my` и пользователь не залогинен или передан неверный токен.*


#### Топ N элементов контента
##### [`POST` `P` `/api/content/top`](http://funstream.tv/api/content/top)
**запрос**
```ts
{
    content: string; // Тип контента, [stream]
    category: { // Категория, любой из параметров
        id: number | null; // Идентификатор категории
        slug: string | null; // Короткое имя категории, top для верхней
    },
    amount: number; // Количество элементов в ответе
}
```
**ответ**
```ts
{
    content: [
        Object, // Данные соотвествующего элемента контента, см ниже
        ...
    ]
}
```
*Вернёт top-{amount} стримов, отсортированных по рейтингу.*  
*Вернёт ошибку если переданы неверные данные категории или контент.*


#### Поля элемента контента

В ответе запросов фильтра у элемента контента есть обязательные поля(присутствуют всегда)
```ts
{
    id: number; // Идентификатор элемента контента
    owner: Object; // Владелец, объект из ответа /api/user
    category: Object; // Категория, объект из ответа /api/category
    name: string; // Название
    adult: boolean; // Флаг 18+
    rating: number; // Рейтинг
    image: string; // Ссылка на картинку
    thumbnail: string; // Ссылка на превью
    hidden: boolean; // Флаг скрытия в списке
    slug: string; // Имя в ссылке на элемент контента(например /stream/<slug>, /room/<slug>)
}
```
*[`/api/user`](#Данные-пользователя), [`/api/category`](#Категория-контента)*

И необязательные, зависят от типа контента

**стрим**
```ts
{
    description: string;
    start_at: unixtime;
}
```
*[описание полей стрима](#Данные-стрима)*

**комната**
```ts
{
    available: boolean;
    mode: string;
}
```
*[описание полей комнаты](room.md#Данные-комнаты)*


## Подписки

#### Подписаться
##### [`POST` `A` `/api/subscribe/add`](http://funstream.tv/api/subscribe/add)
**запрос**
```ts
{
    content: string; // Тип контента, [stream]
    id: number; // Идентификатор элемента контента
}
```
**ответ**
```ts
[]
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Количество активных подписок
##### [`POST` `A` `/api/subscribe/amount`](http://funstream.tv/api/subscribe/amount)
**запрос**
```ts
{
    content: string; // Тип контента, [stream]
}
```
**ответ**
```ts
{
    amount: number; // Количество активных подписок
}
```
*Вернёт количество активных(онлайн) элементов в подписках у пользователя.*  
*Вернёт ошибку если передан наверный тип контента, пользователь не залогинен или передан неверный токен.*


#### Проверить подписку
##### [`POST` `A` `/api/subscribe/check`](http://funstream.tv/api/subscribe/check)
**запрос**
```ts
{
    content: string; // Тип контента, [stream, room]
    id: number; // Идентификатор элемента контента
}
```
**ответ**
```ts
{
    result: boolean; // true в случае наличия подписки
}
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Список подписок
##### [`POST` `A` `/api/subscribe/list`](http://funstream.tv/api/subscribe/list)
**запрос**
```ts
{
    content: string; // Тип контента, [stream]
}
```
**ответ**
```ts
[
    Object, // Данные элемента контента, объект из ответа /api/stream
    ...
]
```
*В данный момент работает неверно.*  
*Вернёт ошибку если передан наверный тип контента, пользователь не залогинен или передан неверный токен.*


#### Отписаться
##### [`POST` `A` `/api/subscribe/remove`](http://funstream.tv/api/subscribe/remove)
**запрос**
```ts
{
    content: string; // Тип контента, [stream]
    id: number; // Идентификатор элемента контента
}
```
**ответ**
```ts
[]
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Список подписчиков пользователя
##### [`POST` `A` `/api/subscribe/subscribers`](http://funstream.tv/api/subscribe/subscribers)
**запрос**
```ts
{
    content: string; // Тип контента, [stream]
}
```
**ответ**
```ts
[
    Object, // Данные юзера, объект из ответа /api/user
    ...
]
```
*[`/api/user`](#Данные-пользователя)*  
*Вернёт список подписчиков на текущего юзера, если он является стримером(имеет запись о стриме в бд).*  
*Вернёт ошибку если передан наверный тип контента, пользователь не залогинен или передан неверный токен.*


## Игноры

#### Добавить в список игнорируемых
##### [`POST` `A` `/api/ignore/add`](http://funstream.tv/api/ignore/add)
**запрос**
```ts
{
    content: string; // Тип контента, [stream, chat]
    item: number; // Идентификатор элемента контента
}
```
**ответ**
```ts
[]
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Проверить на игнор
##### [`POST` `A` `/api/ignore/check`](http://funstream.tv/api/ignore/check)
**запрос**
```ts
{
    content: string; // Тип контента, [stream, chat]
    item: number; // Идентификатор элемента контента
}
```
**ответ**
```ts
{
    ignored: boolean; // true если в игноре
}
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


#### Список игнорируемого
##### [`POST` `A` `/api/ignore/list`](http://funstream.tv/api/ignore/list)
**запрос**
```ts
{
    content: string; // Тип контента, [stream, chat]
}
```
**ответ**
```ts
[
    {
        content: string; // Тип контента, [stream, chat]
        item: number; // Идентификатор элемента контента
    },
    ...
]
```
*Вернёт ошибку если передан наверный тип контента, пользователь не залогинен или передан неверный токен.*


#### Удалить из списка игнорируемого
##### [`POST` `A` `/api/ignore/remove`](http://funstream.tv/api/ignore/remove)
**запрос**
```ts
{
    content: string; // Тип контента, [stream, chat]
    item: number; // Идентификатор элемента контента
}
```
**ответ**
```ts
[]
```
*Вернёт ошибку если передан неверный тип контента, элемент контента не существует, пользователь не залогинен или передан неверный токен.*


## Мастерстримеры

#### Список иконок и смайлов мастерстримеров
##### [`POST` `P` `/api/masterstreamer/list`](http://funstream.tv/api/masterstreamer/list)
**запрос**
```ts
{}
```
**ответ**
```ts
[
    { // Данные мастерстримера
        userId: number; // Идентификатор пользователя
        icon: string | null; // Полная ссылка на иконку, если она есть
        smiles: [ // Список смайлов
            Object, // Смайл, объект из ответа /api/smile
            ...
        ]
    ],
    ...
]
```
*[`/api/smile`](smile.md#Доступные-смайлы)*  
*Список мастерстримеров, у которых одобрен хотя бы один смайл.*


#### Список выбранных пользователями иконок
##### [`POST` `P` `/api/masterstreamer/icon/list`](http://funstream.tv/api/masterstreamer/icon/list)
**запрос**
```ts
{}
```
**ответ**
```ts
[
    { // Выбранная пользователем иконка
        userId: number; // Идентификатор пользователя
        streamerId: number; // Идентификатор стримера, если это иконка мастерстримера, иначе 0
        icon: string; // Полная ссылка на выбранную иконку
    ],
    ...
]
```
*Список пользователей, выбравших конкретную иконку, с данными этой иконки. Если `streamerId` 0, то у пользователя выбрана кастомная иконка не связанная с мастерстримерами. Если пользователь не выбирал конкретную иконку, то независимо от наличия доступных ему иконок, его нет в этом списке.*


## Расписание

#### Список расписания
##### [`POST` `P` `/api/schedule/get`](http://funstream.tv/api/schedule/get)
**запрос**
```ts
{}
```
**ответ**
```ts
[
    { // Данные записи в расписании
        description: string; // Описание
        time: unixtime; // Время начала
        online: boolean; // Онлайн статус стрима
        nodeId: number; // nodeId sc2tv для ссылки на стрим /node/<nodeId>
        user: number; // Данные стримера, объект из ответа /api/user
    ],
    ...
]
```
*[`/api/user`](#Данные-пользователя)*


#### Расписание пользователя
##### [`POST` `Sc` `/api/schedule/my`](http://funstream.tv/api/schedule/my)
**запрос**
```ts
{}
```
**ответ**
```ts
[
    { // Данные записи в расписании
        description: string; // Описание
        time: unixtime; // Время начала
        user: number; // Данные стримера, объект из ответа /api/user
    ],
    ...
]
```
*Вернёт ошибку если текущий пользователь не имеет роли `schedule`.*


#### Изменить расписание пользователя
##### [`POST` `Sc` `/api/schedule/set`](http://funstream.tv/api/schedule/set)
**запрос**
```ts
{
    schedule: [ // Новое расписание
        { // Данные записи в расписании
            description: string; // Описание
            time: unixtime; // Время начала
        },
        ...
    ]
}
```
**ответ**
```ts
{}
```
*Вернёт ошибку если текущий пользователь не имеет роли `schedule`.*


## Майлстоуны

#### Список майлстоунов
##### [`POST` `P` `/api/milestone/get`](http://funstream.tv/api/milestone/get)
**запрос**
```ts
{
    streamerId: number; // Идентификатор стримера
}
```
**ответ**
```ts
{
    startPoint: unixtime; // Время отсчёта собираемого доната
    donatedAmount: float; // Собранный донат с указанного времени
    milestones: [ // Список майлстоунов
        { // Данные майлстоуна
            active: boolean; // Флаг активного майлстоуна, false если собрано/выполнено
            amount: float; // Необходимая сумма с времени отсчёта
            description: string; // Описание майлстоуна
            url: string; // Ссылка на запись выполненнного майлстоуна
        },
        ...
    ]
}
```
*Вернёт ошибку если стример не выставил время отсчёта.*


#### Майлстоуны пользователя
##### [`POST` `A` `/api/milestone/my`](http://funstream.tv/api/milestone/my)
**запрос**
```ts
{}
```
**ответ**
```ts
{
    startPoint: unixtime; // Время отсчёта собираемого доната
    milestones: [ // Список майлстоунов
        // Массив milestones из ответа /api/milestone/get
    ]
}
```
*[`/api/milestone/get`](#Список-майлстоунов)*  
*Майлстоуны текущего пользователя.*


#### Изменить майлстоуны пользователя
##### [`POST` `A` `/api/milestone/set`](http://funstream.tv/api/milestone/set)
**запрос**
```ts
{
    startPoint: unixtime; // Время отсчёта собираемого доната
    milestones: [ // Список майлстоунов
        // Массив milestones из ответа /api/milestone/get
    ]
}
```
**ответ**
```ts
[]
```
*[`/api/milestone/get`](#Список-майлстоунов)*  
*Вернёт ошибку если не указано любое из полей майлстоунов.*


## Сезоны соревнования

#### Данные текущего сезона
##### [`POST` `P` `/api/season/get`](http://funstream.tv/api/season/get)
**запрос**
```ts
{}
```
**ответ**
```ts
{
    start: unixtime; // Время начала сезона
    end: unixtime; // Время завершения сезона, для активного 0
    active: boolean; // Статус сезона
}
```
*Вернёт ошибку если сейчас нет активного сезона*


#### Старт сезона
##### [`POST` `Se` `/api/season/start`](http://funstream.tv/api/season/start)
**запрос**
```ts
{}
```
**ответ**
```ts
[]
```
*Вернёт ошибку если есть активный сезон.*


#### Завершение сезона
##### [`POST` `Se` `/api/season/stop`](http://funstream.tv/api/season/stop)
**запрос**
```ts
{}
```
**ответ**
```ts
[]
```
*Вернёт ошибку если нет активного сезона.*


#### Топ сезона
##### [`POST` `P` `/api/season/top`](http://funstream.tv/api/season/top)
**запрос**
```ts
{}
```
**ответ**
```ts
{
    auction: Object | null { // Данные аукциона
        bonusTime: unixtime; // Бонусное время
        end: unixtime; // Время окончания аукциона
        total: float; // Собранная сумма
        lastDonates: [ // Список последних 5 донатов участникам соревнования
            { // Донат участнику соревнования
                donater: Object; // Данные донатера, объект из ответа /api/user
                streamer: Object; // Данные донатера, объект из ответа /api/user
                amount: float; // Сумма доната
                message: string; // Сообщение при донате
                time: unixtime; // Время перевода
            },
            ...
        ]
    },
    top: [ // Топ участников соревнования
        { // Участник соревнования
            user: Object; // Данные стримера, объект из ответа /api/user
            amount: float; // Собранная за сезон сумма
            online: boolean; // Онлайн статус стрима
            nodeId: number; // nodeId sc2tv для ссылки на стрим /node/<nodeId>
        },
        ...
    ]
}
```
*[`/api/user`](#Данные-пользователя)*  
*Список участников отсортирован по собранной сумме по уменьшению. Данные аукциона доступны только когда он активен.*  
*Вернёт ошибку если нет активного сезона.*


## Уровни

#### Мои уровни
##### [`POST` `A` `/api/level/my`](http://funstream.tv/api/level/my)
**запрос**
```ts
{}
```
**ответ**
```ts
{
    streamer: [ // Уровни у стримеров
        {
            level: number; // Уровень
            until: unixtime; // Время окончания
            user: Object; // Данные стримера, объект из ответа /api/user
        },
        ...
    ]
}
```
*[`/api/user`](#Данные-пользователя)*


#### Уровни моих премиум юзеров
##### [`POST` `A` `/api/level/premiumUsers`](http://funstream.tv/api/level/premiumUsers)
**запрос**
```ts
{}
```
**ответ**
```ts
[
    {
        level: number; // Уровень
        until: unixtime; // Время окончания
        user: Object; // Данные пользователя, объект из ответа /api/user
    },
    ...
]
```
*[`/api/user`](#Данные-пользователя)*  
*Под преумиум пользователями подразумеваются пользователи имеющие уровень у текущего юзера-стримера.*


## Аукцион окончания стрима

#### Активные аукционы окончания стрима
##### [`POST` `P` `/api/prolonger/active`](http://funstream.tv/api/prolonger/active)
**запрос**
```ts
{}
```
**ответ**
```ts
{
    streamers: [
        number, // Идентификатор стримера
        ...
    ]
}
```


#### Данные аукциона окончания стрима
##### [`POST` `P` `/api/prolonger/get`](http://funstream.tv/api/prolonger/get)
**запрос**
```ts
{
    streamerId: number; // Идентификатор стримера
}
```
**ответ**
```ts
{
    streamerId: number; // Идентификатор стримера
    active: boolean; // Статус аукциона, false если завершён
    amount: number; // Собранная за время аукциона сумма
    minuteCost: number; // Стоимость продления на минуту
    start: unixtime; // Время старта аукциона
    deadline: unixtime; // Дедлайн
    end: unixtime; // Время окончания аукциона, если дедлайн меньше времени на которое продлили то (end === deadline)
}
```
*Статус аукциона определять только по полю `active`, а не по `end`, т.к. в конце есть задержка для учёта донатов в последние секунды.*  
*Может вернуть ошибку если у стримера не активен аукцион.*


#### Запустить аукцион окончания стрима
##### [`POST` `A` `/api/prolonger/start`](http://funstream.tv/api/prolonger/start)
**запрос**
```ts
{
    minuteCost: number; // Стоимость продления на минуту
    deadline: unixtime; // Дедлайн
    end: unixtime; // Стартовое время окончания аукциона
}
```
**ответ**
```ts
{
    ... // Объект из ответа /api/prolonger/get
}
```
*[`/api/prolonger/get`](#Данные-аукциона-окончания-стрима)*


## Дополнительные вызовы

#### Пакетный запрос
##### [`POST` `P` `/api/bulk`](http://funstream.tv/api/bulk)
**запрос**
```ts
{
    command: [ // Массив запросов
        [ // Запрос
            string; // Урл запроса, например /api/user
            Object; // Параметры запроса
        ],
        ...
    ]
}
```
**ответ**
```ts
[
    [ // Результат соответствующего запроса
        string; // Урл запроса, например /api/user
        Object; // Параметры запроса
        Object | Array; // Ответ на запрос
        boolean; // Статус запроса, true на успешное выполнение
    ],
    ...
]
```
*Позволяет получить результаты нескольких запросов за один.*  
*Для каждого запроса возвращает массив с его данными, статусом выполнения и результатом. Индекс ответа соответствует индексу в массиве запросов.*  
*Если запрос дал ошибку, то в ответе на этот запрос будет объект ошибки и статус false.*
