Уведомления
===========
- [**Событие уведомления**](#Событие-уведомления)
- [**Прочие уведомления**](#Прочие-уведомления)
    - [**Донат в чате**](#Донат-в-чате)
        - [`chatChannelDonateLevel` Изменение донат уровня канала чата](#Изменение-донат-уровня-канала-чата)
    - [**Сторонние сервисы в чате**](#Сторонние-сервисы-в-чате)
        - [`chatThirdpartySendMessageError` Ошибка отправки сообщения в чат сервис](#Ошибка-отправки-сообщения-в-чат-сервис)


Событие уведомления
-------------------
Для уведомлений пользователя о всяческом используется событие вебсокетов [чата](chat.md#Протокол-взаимодействия) `/notifier/message` следующего формата
##### `WS` `P` `/notifier/message`
```ts
{
    userId: number; // Идентификатор пользователя, 0 по умолчанию
    sid: string; // Идентификатор сессии вебсокета, пустая строка по умолчания
    channel: string; // Идентификатор канала, пустая строка по умолчания
    type: string; // Тип уведомления
    data: Object; // Данные уведомления, см. описание конкретного уведомления
}
```
Уведомления могут слаться точечно залогиненному пользователю(во все открытые сессии),
конкретному соединению по `sid`, сессиям в конкретном канале чата или всем подсоединённым сессиям.  
Формат поля `data` произвольный и зависит от конкретного уведомления. Далее для уведомлений указаны тип и содержимое поля `data`.


Прочие уведомления
------------------

### Донат в чате

#### Изменение донат уровня канала чата
##### `chatChannelDonateLevel`
```ts
{
    channel: string; // Идентификатор канала
    level: number; // Новый уровень
    amount: number; // Полная сумма доната
    topDonator: string; // Имя топ донатера(который внёс >= 90% суммы текущего доната за рассматриваемый период)
}
```
*Приходит при изменении уровня по суммарному донату(без прямых переводов и антидоната) за некоторый период
(например 1 уровень - 300 пекоинов, 2 - 600 и т.д.). Только для каналов чата стримов.
Используется для выдачи пользователям в этом канале бонусов(например смайлы соответствующего уровня).*


### Сторонние сервисы в чате

#### Ошибка отправки сообщения в чат сервис
##### `chatThirdpartySendMessageError`
```ts
{
    message: string; // Текст ошибки
}
```
*Приходит при ошибке отправки сообщения в сторонние сервисы: twitch, goodgame.*
